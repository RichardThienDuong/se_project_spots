!function(){"use strict";var e="/";const t={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__submit-btn",inactiveButtonClass:"modal__submit-btn_disabled",inputErrorClass:"modal__input_type_error",errorClass:".modal__error"},o=(e,t,o)=>{e.querySelector(`#${t.id}-error`).textContent="",t.classList.remove(o.inputErrorClass)},r=(e,t)=>{e.disabled=!0,e.classList.add(t.inactiveButtonClass)},n=(e,t,o)=>{(e=>e.some(e=>!e.validity.valid))(e)?r(t,o):((e,t)=>{e.disabled=!1,e.classList.remove(t.inactiveButtonClass)})(t,o)};var l=e+"8650253b58b46f0f1c06.svg",a=e+"2fc47fd8e9a9bcd9612f.jpg",s=e+"d38272e02bb4f1ab1c37.svg",c=e+"40608da7369d39bc1077.svg";document.getElementById("logo").src=l,document.getElementById("avatar").src=a,document.getElementById("editIcon").src=s,document.getElementById("postIcon").src=c;const i={profileModal:document.querySelector("#profile-modal"),pictureModal:document.querySelector("#picture-modal"),postModal:document.querySelector("#post-modal"),profileForm:document.forms["profile-form"],postForm:document.forms["post-form"]},p={cardTemplate:document.querySelector("#card-template"),cardsList:document.querySelector(".cards__section"),profileEditOpenButton:document.querySelector(".profile__edit-btn"),profileCloseButton:i.profileModal.querySelector(".modal__close-btn"),profileName:document.querySelector(".profile__title"),profileDescription:document.querySelector(".profile__description"),profileInputName:document.querySelector("#profile_name"),profileInputDescription:document.querySelector("#profile_description"),profileSaveButton:i.profileModal.querySelector(".modal__submit-btn"),pictureModalImage:i.pictureModal.querySelector(".modal__preview-image"),pictureModalName:i.pictureModal.querySelector(".modal__preview-name"),pictureCloseButton:i.pictureModal.querySelector(".modal__close-btn"),postModalCloseButton:i.postModal.querySelector(".modal__close-btn"),postModalOpenButton:document.querySelector(".profile__post-btn"),postInputLink:i.postForm.querySelector("#post_link"),postInputName:i.postForm.querySelector("#post_name"),postSubmitButton:i.postForm.querySelector(".modal__submit-btn")};function d(e,t="append",o,r){const n=function(e,t,o){const r=t.cardTemplate.content.querySelector(".card").cloneNode(!0),n=r.querySelector(".card__description"),l=r.querySelector(".card__image"),a=r.querySelector(".card__like-btn"),s=r.querySelector(".card__delete-btn");return n.textContent=e.name,l.src=e.link,l.alt=e.name,a.addEventListener("click",()=>{a.classList.toggle("card__like-btn_liked")}),s.addEventListener("click",()=>{r.remove()}),l.addEventListener("click",()=>{t.pictureModalImage.src=l.src,t.pictureModalImage.alt=l.alt,t.pictureModalName.textContent=l.alt,u(o.pictureModal)}),r}(e,o,r);o.cardsList[t](n)}function u(e){e.classList.add("modal_opened"),y.addEventListeners(y[e.id])}function m(e){e.classList.remove("modal_opened"),y.removeEventListeners(y[e.id])}function f(e){const t=e.target.closest(".modal");t.classList.contains("modal_opened")&&m(t)}function _(e){e.target.classList.contains("modal_opened")&&m(e.target)}function v(e){const t=document.querySelector(".modal_opened");"Escape"===e.key&&m(t)}[{name:"Val Thorens",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/1-photo-by-moritz-feldmann-from-pexels.jpg"},{name:"Restaurant terrace",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/2-photo-by-ceiline-from-pexels.jpg"},{name:"An outdoor cafe",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/3-photo-by-tubanur-dogan-from-pexels.jpg"},{name:"A very long bridge, over the forest and through the trees",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/4-photo-by-maurice-laschet-from-pexels.jpg"},{name:"Tunnel with morning light",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/5-photo-by-van-anh-nguyen-from-pexels.jpg"},{name:"Mountain house",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/6-photo-by-moritz-feldmann-from-pexels.jpg"}].forEach(e=>{d(e,void 0,p,i)});const y={"profile-modal":[[function(e){e.preventDefault(),p.profileName.textContent=p.profileInputName.value,p.profileDescription.textContent=p.profileInputDescription.value,m(i.profileModal)},"submit",i.profileForm],[f,"click",p.profileCloseButton],[_,"click",i.profileModal],[v,"keydown",document]],"post-modal":[[function(e){e.preventDefault(),d({link:p.postInputLink.value,name:p.postInputName.value},"prepend",p,i),r(p.postSubmitButton,t),i.postForm.reset(),m(i.postModal)},"submit",i.postForm],[f,"click",p.postModalCloseButton],[_,"click",i.postModal],[v,"keydown",document]],"picture-modal":[[f,"click",p.pictureCloseButton],[_,"click",i.pictureModal],[v,"keydown",document]],addEventListeners(e){e.forEach(([e,t,o])=>{o.addEventListener(t,e)})},removeEventListeners(e){e.forEach(([e,t,o])=>{o.removeEventListener(t,e)})}};var b;p.postModalOpenButton.addEventListener("click",()=>{u(i.postModal)}),p.profileEditOpenButton.addEventListener("click",()=>{var e,r,n;p.profileInputName.value=p.profileName.textContent,p.profileInputDescription.value=p.profileDescription.textContent,e=i.profileModal,r=[p.profileInputName,p.profileInputDescription],n=t,r.forEach(t=>{o(e,t,n)}),u(i.profileModal)}),b=t,document.querySelectorAll(b.formSelector).forEach(e=>{((e,t)=>{const l=Array.from(e.querySelectorAll(t.inputSelector)),a=e.querySelector(t.submitButtonSelector);n(l,a,t),e.addEventListener("reset",()=>{r(a,t)}),l.forEach(r=>{r.addEventListener("input",()=>{((e,t,r)=>{t.validity.valid?o(e,t,r):((e,t,o,r)=>{e.querySelector(`#${t.id}-error`).textContent=o,t.classList.add(r.inputErrorClass)})(e,t,t.validationMessage,r)})(e,r,t),n(l,a,t)})})})(e,b)})}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QkMsRUFBV0osRUFBZVAsUUFTOUM2RixDQUFrQi9GLEVBQWFFLEkiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvd2VicGFjay9ydW50aW1lL3B1YmxpY1BhdGgiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy9zY3JpcHRzL3ZhbGlkYXRpb24uanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy9wYWdlcy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBUaGUgcmVxdWlyZSBzY29wZVxudmFyIF9fd2VicGFja19yZXF1aXJlX18gPSB7fTtcblxuIiwiX193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCIvXCI7IiwiY29uc3Qgc2V0dGluZ3MgPSB7XG4gIGZvcm1TZWxlY3RvcjogXCIubW9kYWxfX2Zvcm1cIixcbiAgaW5wdXRTZWxlY3RvcjogXCIubW9kYWxfX2lucHV0XCIsXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fc3VibWl0LWJ0blwiLFxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcIm1vZGFsX19zdWJtaXQtYnRuX2Rpc2FibGVkXCIsXG4gIGlucHV0RXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXRfdHlwZV9lcnJvclwiLFxuICBlcnJvckNsYXNzOiBcIi5tb2RhbF9fZXJyb3JcIlxufVxuXG4vKiB0byBoaWRlIGVycm9yIG1lZHNzYWdlIGFuZCByZWQgYm9yZGVyICovXG5jb25zdCBoaWRlSW5wdXRFcnJvciA9IChmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBjb25maWcpID0+IHtcbiAgY29uc3QgZXJyb3JNc2dFbGVtZW50ID0gZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xuICBlcnJvck1zZ0VsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xuICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShjb25maWcuaW5wdXRFcnJvckNsYXNzKTtcbn1cblxuLyogdG8gc2hvdyBlcnJvciBtZXNzYWdlIGFuZCByZWQgYm9yZGVyICovXG5jb25zdCBzaG93SW5wdXRFcnJvciA9IChmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBlcnJvck1lc3NhZ2UsIGNvbmZpZykgPT4ge1xuICBjb25zdCBlcnJvck1zZ0VsZW1lbnQgPSBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XG4gIGVycm9yTXNnRWxlbWVudC50ZXh0Q29udGVudCA9IGVycm9yTWVzc2FnZTtcbiAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQoY29uZmlnLmlucHV0RXJyb3JDbGFzcyk7XG5cbn1cblxuLyogdG8gY2hlY2sgVmFsaWRpdHkgb2YgaW5wdXQgYW5kIHJlc3BvbmQgd2l0aCBzaG93L2hpZGUgZXJyb3IgZnVuY3Rpb25zICovXG5jb25zdCBjaGVja0lucHV0VmFsaWRpdHkgPSAoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgY29uZmlnKSA9PiB7XG4gIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgc2hvd0lucHV0RXJyb3IoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlLCBjb25maWcpO1xuICB9IGVsc2Uge1xuICAgIGhpZGVJbnB1dEVycm9yKGZvcm1FbGVtZW50LCBpbnB1dEVsZW1lbnQsIGNvbmZpZyk7XG4gIH1cbn1cblxuY29uc3QgaGFzSW52YWxpZElucHV0ID0gKGlucHV0TGlzdCkgPT4ge1xuICByZXR1cm4gaW5wdXRMaXN0LnNvbWUoKGlucHV0KSA9PiAhaW5wdXQudmFsaWRpdHkudmFsaWQgKTtcbn07XG5cbmNvbnN0IGRpc2FibGVCdXR0b24gPSAoYnV0dG9uRWxlbWVudCwgY29uZmlnKSA9PiB7XG4gIGJ1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSB0cnVlO1xuICBidXR0b25FbGVtZW50LmNsYXNzTGlzdC5hZGQoY29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xufVxuXG5jb25zdCBlbmFibGVCdXR0b24gPSAoYnV0dG9uRWxlbWVudCwgY29uZmlnKSA9PiB7XG4gIGJ1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSBmYWxzZTtcbiAgYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbn1cblxuY29uc3QgcmVzZXRWYWxpZGF0aW9uID0gKGZvcm1FbGVtZW50LCBpbnB1dExpc3QsIGNvbmZpZykgPT4ge1xuICBpbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcbiAgICBoaWRlSW5wdXRFcnJvcihmb3JtRWxlbWVudCwgaW5wdXQsIGNvbmZpZyk7XG4gIH0pXG59XG5cbmNvbnN0IHRvZ2dsZUJ1dHRvblN0YXRlID0gKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCwgY29uZmlnKSA9PiB7XG4gIGlmIChoYXNJbnZhbGlkSW5wdXQoaW5wdXRMaXN0KSkge1xuICAgIGRpc2FibGVCdXR0b24oYnV0dG9uRWxlbWVudCwgY29uZmlnKTtcbiAgfSBlbHNlIHtcbiAgICBlbmFibGVCdXR0b24oYnV0dG9uRWxlbWVudCwgY29uZmlnKTtcbiAgfVxufVxuXG4vKiB0byBzZXQgTGlzdGVuZXJzIGZvciBhbGwgaW5wdXRzIGFuZCBjaGFuZ2UgYnV0dG9uIHN0YXRlcyBmb3IgY2hlY2tJbnB1dFZhbGlkaXR5IGZ1bmN0aW9uICovXG5jb25zdCBzZXRFdmVudExpc3RlbmVycyA9IChmb3JtRWxlbWVudCwgY29uZmlnKSA9PiB7XG4gIGNvbnN0IGlucHV0TGlzdCA9IEFycmF5LmZyb20oZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbChjb25maWcuaW5wdXRTZWxlY3RvcikpO1xuICBjb25zdCBidXR0b25FbGVtZW50ID0gZm9ybUVsZW1lbnQucXVlcnlTZWxlY3Rvcihjb25maWcuc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xuXG4gIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCwgY29uZmlnKTtcblxuICBmb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwicmVzZXRcIiwgKCkgPT4ge1xuICAgIGRpc2FibGVCdXR0b24oYnV0dG9uRWxlbWVudCwgY29uZmlnKTtcbiAgfSlcblxuICBpbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgKCkgPT4ge1xuICAgICAgY2hlY2tJbnB1dFZhbGlkaXR5KGZvcm1FbGVtZW50LCBpbnB1dEVsZW1lbnQsIGNvbmZpZyk7XG4gICAgICB0b2dnbGVCdXR0b25TdGF0ZShpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQsIGNvbmZpZyk7XG4gICAgfSlcbiAgfSlcbn07XG5cbi8qIFRvIHJ1biBhbGwgZm9ybXMgZm9yIFNldEV2ZW50TGlzdGVuZXIgZnVuY3Rpb24gKi9cbiBjb25zdCBlbmFibGVWYWxpZGF0aW9uID0gKGNvbmZpZykgPT4ge1xuICBjb25zdCBmb3JtTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoY29uZmlnLmZvcm1TZWxlY3RvcikgO1xuICBmb3JtTGlzdC5mb3JFYWNoKChmb3JtRWxlbWVudCkgPT4ge1xuICAgIHNldEV2ZW50TGlzdGVuZXJzKGZvcm1FbGVtZW50LCBjb25maWcpO1xuICB9KTtcbn07XG5cbmV4cG9ydCB7IHNldHRpbmdzLCBlbmFibGVWYWxpZGF0aW9uLCByZXNldFZhbGlkYXRpb24sIGRpc2FibGVCdXR0b24gfTsiLCJpbXBvcnQgeyBlbmFibGVWYWxpZGF0aW9uLCBzZXR0aW5ncywgcmVzZXRWYWxpZGF0aW9uLCBkaXNhYmxlQnV0dG9uIH0gZnJvbSBcIi4uL3NjcmlwdHMvdmFsaWRhdGlvbi5qc1wiO1xuaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcbmltcG9ydCBsb2dvIGZyb20gXCIuLi9pbWFnZXMvTG9nby5zdmdcIjtcbmltcG9ydCBhdmF0YXIgZnJvbSBcIi4uL2ltYWdlcy9hdmF0YXIuanBnXCI7XG5pbXBvcnQgZWRpdEljb24gZnJvbSBcIi4uL2ltYWdlcy9lZGl0LWljb24uc3ZnXCI7XG5pbXBvcnQgcG9zdEljb24gZnJvbSBcIi4uL2ltYWdlcy9wb3N0LWljb24uc3ZnXCI7XG5cbmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2dvJykuc3JjID0gbG9nbztcbmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhdmF0YXInKS5zcmMgPSBhdmF0YXI7XG5kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZWRpdEljb24nKS5zcmMgPSBlZGl0SWNvbjtcbmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwb3N0SWNvbicpLnNyYyA9IHBvc3RJY29uO1xuXG5cbmNvbnN0IGluaXRpYWxDYXJkcyA9IFtcbiAge1xuICAgICAgbmFtZTogXCJWYWwgVGhvcmVuc1wiLFxuICAgICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL3Nwb3RzLzEtcGhvdG8tYnktbW9yaXR6LWZlbGRtYW5uLWZyb20tcGV4ZWxzLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgICBuYW1lOiBcIlJlc3RhdXJhbnQgdGVycmFjZVwiLFxuICAgICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL3Nwb3RzLzItcGhvdG8tYnktY2VpbGluZS1mcm9tLXBleGVscy5qcGdcIixcbiAgfSxcbiAge1xuICAgICAgbmFtZTogXCJBbiBvdXRkb29yIGNhZmVcIixcbiAgICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy8zLXBob3RvLWJ5LXR1YmFudXItZG9nYW4tZnJvbS1wZXhlbHMuanBnXCIsXG4gIH0sXG4gIHtcbiAgICAgIG5hbWU6IFwiQSB2ZXJ5IGxvbmcgYnJpZGdlLCBvdmVyIHRoZSBmb3Jlc3QgYW5kIHRocm91Z2ggdGhlIHRyZWVzXCIsXG4gICAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvNC1waG90by1ieS1tYXVyaWNlLWxhc2NoZXQtZnJvbS1wZXhlbHMuanBnXCIsXG4gIH0sXG4gIHtcbiAgICAgIG5hbWU6IFwiVHVubmVsIHdpdGggbW9ybmluZyBsaWdodFwiLFxuICAgICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL3Nwb3RzLzUtcGhvdG8tYnktdmFuLWFuaC1uZ3V5ZW4tZnJvbS1wZXhlbHMuanBnXCIsXG4gIH0sXG4gIHtcbiAgICAgIG5hbWU6IFwiTW91bnRhaW4gaG91c2VcIixcbiAgICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy82LXBob3RvLWJ5LW1vcml0ei1mZWxkbWFubi1mcm9tLXBleGVscy5qcGdcIixcbiAgfVxuXTtcblxuY29uc3QgZG9tU2VjdGlvbnMgPSB7XG4gIHByb2ZpbGVNb2RhbDogZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3Byb2ZpbGUtbW9kYWwnKSxcbiAgcGljdHVyZU1vZGFsOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjcGljdHVyZS1tb2RhbCcpLFxuICBwb3N0TW9kYWw6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNwb3N0LW1vZGFsJyksXG4gIHByb2ZpbGVGb3JtOiBkb2N1bWVudC5mb3Jtc1sncHJvZmlsZS1mb3JtJ10sXG4gIHBvc3RGb3JtOiBkb2N1bWVudC5mb3Jtc1sncG9zdC1mb3JtJ10sXG59XG5cbmNvbnN0ICBkb21SZWZzID0ge1xuICAgY2FyZFRlbXBsYXRlOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjY2FyZC10ZW1wbGF0ZScpLFxuICAgY2FyZHNMaXN0OiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZHNfX3NlY3Rpb24nKSxcbiAgIHByb2ZpbGVFZGl0T3BlbkJ1dHRvbjogZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2VkaXQtYnRuJyksXG4gICBwcm9maWxlQ2xvc2VCdXR0b246IGRvbVNlY3Rpb25zLnByb2ZpbGVNb2RhbC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX2Nsb3NlLWJ0bicpLFxuICAgcHJvZmlsZU5hbWU6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX190aXRsZScpLFxuICAgcHJvZmlsZURlc2NyaXB0aW9uOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fZGVzY3JpcHRpb24nKSxcbiAgIHByb2ZpbGVJbnB1dE5hbWU6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNwcm9maWxlX25hbWUnKSxcbiAgIHByb2ZpbGVJbnB1dERlc2NyaXB0aW9uOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjcHJvZmlsZV9kZXNjcmlwdGlvbicpLFxuICAgcHJvZmlsZVNhdmVCdXR0b246IGRvbVNlY3Rpb25zLnByb2ZpbGVNb2RhbC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX3N1Ym1pdC1idG4nKSxcbiAgIHBpY3R1cmVNb2RhbEltYWdlOiBkb21TZWN0aW9ucy5waWN0dXJlTW9kYWwucXVlcnlTZWxlY3RvcignLm1vZGFsX19wcmV2aWV3LWltYWdlJyksXG4gICBwaWN0dXJlTW9kYWxOYW1lOiBkb21TZWN0aW9ucy5waWN0dXJlTW9kYWwucXVlcnlTZWxlY3RvcignLm1vZGFsX19wcmV2aWV3LW5hbWUnKSxcbiAgIHBpY3R1cmVDbG9zZUJ1dHRvbjogZG9tU2VjdGlvbnMucGljdHVyZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fY2xvc2UtYnRuJyksXG4gICBwb3N0TW9kYWxDbG9zZUJ1dHRvbjogZG9tU2VjdGlvbnMucG9zdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fY2xvc2UtYnRuJyksXG4gICBwb3N0TW9kYWxPcGVuQnV0dG9uOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fcG9zdC1idG4nKSxcbiAgIHBvc3RJbnB1dExpbms6IGRvbVNlY3Rpb25zLnBvc3RGb3JtLnF1ZXJ5U2VsZWN0b3IoJyNwb3N0X2xpbmsnKSxcbiAgIHBvc3RJbnB1dE5hbWU6IGRvbVNlY3Rpb25zLnBvc3RGb3JtLnF1ZXJ5U2VsZWN0b3IoJyNwb3N0X25hbWUnKSxcbiAgIHBvc3RTdWJtaXRCdXR0b246IGRvbVNlY3Rpb25zLnBvc3RGb3JtLnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fc3VibWl0LWJ0bicpXG59O1xuXG4vKiBDYXJkcyAgKi9cbmZ1bmN0aW9uIGdldENhcmRFbGVtZW50KGRhdGEsIGRvbVJlZnMsIGRvbVNlY3Rpb25zKSB7XG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gZG9tUmVmcy5jYXJkVGVtcGxhdGUuY29udGVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZCcpLmNsb25lTm9kZSh0cnVlKTtcbiAgY29uc3QgY2FyZERlc2NyaXB0aW9uRWwgPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fZGVzY3JpcHRpb24nKTtcbiAgY29uc3QgY2FyZEltYWdlRWwgPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9faW1hZ2UnKTtcbiAgY29uc3QgY2FyZExpa2VCdG4gPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fbGlrZS1idG4nKTtcbiAgY29uc3QgY2FyZERlbGV0ZUJ0biA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19kZWxldGUtYnRuJyk7XG5cbiAgY2FyZERlc2NyaXB0aW9uRWwudGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XG4gIGNhcmRJbWFnZUVsLnNyYyA9IGRhdGEubGluaztcbiAgY2FyZEltYWdlRWwuYWx0ID0gZGF0YS5uYW1lO1xuXG4gIGNhcmRMaWtlQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgIGNhcmRMaWtlQnRuLmNsYXNzTGlzdC50b2dnbGUoJ2NhcmRfX2xpa2UtYnRuX2xpa2VkJyk7XG4gIH0pXG5cbiAgY2FyZERlbGV0ZUJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICBjYXJkRWxlbWVudC5yZW1vdmUoKTtcbiAgfSlcblxuICBjYXJkSW1hZ2VFbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICBkb21SZWZzLnBpY3R1cmVNb2RhbEltYWdlLnNyYyA9IGNhcmRJbWFnZUVsLnNyYztcbiAgICBkb21SZWZzLnBpY3R1cmVNb2RhbEltYWdlLmFsdCA9IGNhcmRJbWFnZUVsLmFsdDtcbiAgICBkb21SZWZzLnBpY3R1cmVNb2RhbE5hbWUudGV4dENvbnRlbnQgPSBjYXJkSW1hZ2VFbC5hbHQ7XG4gICAgb3Blbk1vZGFsKGRvbVNlY3Rpb25zLnBpY3R1cmVNb2RhbCk7XG4gIH0pXG5cbiAgcmV0dXJuIGNhcmRFbGVtZW50O1xufTtcblxuZnVuY3Rpb24gcmVuZGVyQ2FyZChkYXRhLCBtZXRob2QgPSBcImFwcGVuZFwiLCBkb21SZWZzLCBkb21TZWN0aW9ucykge1xuICBjb25zdCBjYXJkRWxlbWVudCA9IGdldENhcmRFbGVtZW50KGRhdGEsIGRvbVJlZnMsIGRvbVNlY3Rpb25zKTtcbiAgZG9tUmVmcy5jYXJkc0xpc3RbbWV0aG9kXShjYXJkRWxlbWVudCk7XG59XG5cbmluaXRpYWxDYXJkcy5mb3JFYWNoKChkYXRhKSA9PiB7XG4gIHJlbmRlckNhcmQoZGF0YSwgdW5kZWZpbmVkLCBkb21SZWZzLCBkb21TZWN0aW9ucyk7XG59KTtcblxuXG4vKiBNb2RhbHMgLyBGb3JtcyAgKi9cbmZ1bmN0aW9uIG9wZW5Nb2RhbChtb2RhbCkge1xuICBtb2RhbC5jbGFzc0xpc3QuYWRkKCdtb2RhbF9vcGVuZWQnKTtcbiAgZXZlbnRNZ3IuYWRkRXZlbnRMaXN0ZW5lcnMoZXZlbnRNZ3JbbW9kYWwuaWRdKTtcbn07XG5mdW5jdGlvbiBjbG9zZU1vZGFsKG1vZGFsKSB7XG4gIG1vZGFsLmNsYXNzTGlzdC5yZW1vdmUoJ21vZGFsX29wZW5lZCcpO1xuICBldmVudE1nci5yZW1vdmVFdmVudExpc3RlbmVycyhldmVudE1nclttb2RhbC5pZF0pO1xufTtcblxuZnVuY3Rpb24gaGFuZGxlUHJvZmlsZUZvcm1TdWJtaXQoZXZ0KSB7XG4gIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICBkb21SZWZzLnByb2ZpbGVOYW1lLnRleHRDb250ZW50ID0gZG9tUmVmcy5wcm9maWxlSW5wdXROYW1lLnZhbHVlO1xuICBkb21SZWZzLnByb2ZpbGVEZXNjcmlwdGlvbi50ZXh0Q29udGVudCA9IGRvbVJlZnMucHJvZmlsZUlucHV0RGVzY3JpcHRpb24udmFsdWU7XG4gIGNsb3NlTW9kYWwoZG9tU2VjdGlvbnMucHJvZmlsZU1vZGFsKTtcbn07XG5cbmZ1bmN0aW9uIGhhbmRsZVBvc3RGb3JtU3VibWl0KGV2dCkge1xuICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgY29uc3QgaW5wdXRWYWx1ZXMgPSB7XG4gICAgbGluazogZG9tUmVmcy5wb3N0SW5wdXRMaW5rLnZhbHVlLFxuICAgIG5hbWU6IGRvbVJlZnMucG9zdElucHV0TmFtZS52YWx1ZSxcbiAgfTtcbiAgcmVuZGVyQ2FyZChpbnB1dFZhbHVlcywgXCJwcmVwZW5kXCIsIGRvbVJlZnMsIGRvbVNlY3Rpb25zKTtcbiAgZGlzYWJsZUJ1dHRvbihkb21SZWZzLnBvc3RTdWJtaXRCdXR0b24sIHNldHRpbmdzKTtcbiAgZG9tU2VjdGlvbnMucG9zdEZvcm0ucmVzZXQoKTtcbiAgY2xvc2VNb2RhbChkb21TZWN0aW9ucy5wb3N0TW9kYWwpO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVDbG9zZUJ1dHRvbihldnQpIHtcbiAgY29uc3QgcG9wdXBNb2RhbCA9IGV2dC50YXJnZXQuY2xvc2VzdChcIi5tb2RhbFwiKTtcbiAgaWYgKHBvcHVwTW9kYWwuY2xhc3NMaXN0LmNvbnRhaW5zKCdtb2RhbF9vcGVuZWQnKSkge1xuICAgIGNsb3NlTW9kYWwocG9wdXBNb2RhbCk7XG4gIH1cbiAgfVxuXG5mdW5jdGlvbiBoYW5kbGVDbGlja0Nsb3NlKGV2dCkge1xuICBpZiAoZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ21vZGFsX29wZW5lZCcpKSB7XG4gICAgY2xvc2VNb2RhbChldnQudGFyZ2V0KTtcbiAgfVxufVxuXG5mdW5jdGlvbiBoYW5kbGVDbG9zZUtleShldnQpIHtcbiAgY29uc3QgcG9wdXBNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9vcGVuZWQnKTtcbiAgaWYgKGV2dC5rZXkgPT09ICdFc2NhcGUnKSB7XG4gICAgY2xvc2VNb2RhbChwb3B1cE1vZGFsKTtcbiAgfVxufVxuXG5jb25zdCBldmVudE1nciA9IHtcbiAgXCJwcm9maWxlLW1vZGFsXCI6IFtcbiAgICBbaGFuZGxlUHJvZmlsZUZvcm1TdWJtaXQsICdzdWJtaXQnLCBkb21TZWN0aW9ucy5wcm9maWxlRm9ybV0sXG4gICAgW2hhbmRsZUNsb3NlQnV0dG9uLCAnY2xpY2snLCBkb21SZWZzLnByb2ZpbGVDbG9zZUJ1dHRvbl0sXG4gICAgW2hhbmRsZUNsaWNrQ2xvc2UsICdjbGljaycsIGRvbVNlY3Rpb25zLnByb2ZpbGVNb2RhbF0sXG4gICAgW2hhbmRsZUNsb3NlS2V5LCAna2V5ZG93bicsIGRvY3VtZW50XVxuICBdLFxuICBcInBvc3QtbW9kYWxcIjogW1xuICAgIFtoYW5kbGVQb3N0Rm9ybVN1Ym1pdCwgJ3N1Ym1pdCcsIGRvbVNlY3Rpb25zLnBvc3RGb3JtXSxcbiAgICBbaGFuZGxlQ2xvc2VCdXR0b24sICdjbGljaycsIGRvbVJlZnMucG9zdE1vZGFsQ2xvc2VCdXR0b25dLFxuICAgIFtoYW5kbGVDbGlja0Nsb3NlLCAnY2xpY2snLCBkb21TZWN0aW9ucy5wb3N0TW9kYWxdLFxuICAgIFtoYW5kbGVDbG9zZUtleSwgJ2tleWRvd24nLCBkb2N1bWVudF1cbiAgXSxcbiAgXCJwaWN0dXJlLW1vZGFsXCI6IFtcbiAgICBbaGFuZGxlQ2xvc2VCdXR0b24sICdjbGljaycsIGRvbVJlZnMucGljdHVyZUNsb3NlQnV0dG9uXSxcbiAgICBbaGFuZGxlQ2xpY2tDbG9zZSwgJ2NsaWNrJywgZG9tU2VjdGlvbnMucGljdHVyZU1vZGFsXSxcbiAgICBbaGFuZGxlQ2xvc2VLZXksICdrZXlkb3duJywgZG9jdW1lbnRdXG4gIF0sXG4gIGFkZEV2ZW50TGlzdGVuZXJzKGxpc3RlbmVycykge1xuICAgIGxpc3RlbmVycy5mb3JFYWNoKChbaGFuZGxlciwgZXZlbnRUeXBlLCBlbGVtZW50XSkgPT4ge1xuICAgICAgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKGV2ZW50VHlwZSwgaGFuZGxlcik7XG4gICAgfSlcbiAgfSxcbiAgcmVtb3ZlRXZlbnRMaXN0ZW5lcnMobGlzdGVuZXJzKSB7XG4gICAgbGlzdGVuZXJzLmZvckVhY2goKFtoYW5kbGVyLCBldmVudFR5cGUsIGVsZW1lbnRdKSA9PiB7XG4gICAgICBlbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZlbnRUeXBlLCBoYW5kbGVyKTtcbiAgICB9KVxuICB9XG59XG5cbi8qIE1haW4gUGFnZSBMaXN0ZW5lcnMgICovXG5kb21SZWZzLnBvc3RNb2RhbE9wZW5CdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gIG9wZW5Nb2RhbChkb21TZWN0aW9ucy5wb3N0TW9kYWwpO1xufSk7XG5cbmRvbVJlZnMucHJvZmlsZUVkaXRPcGVuQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICBkb21SZWZzLnByb2ZpbGVJbnB1dE5hbWUudmFsdWUgPSBkb21SZWZzLnByb2ZpbGVOYW1lLnRleHRDb250ZW50O1xuICBkb21SZWZzLnByb2ZpbGVJbnB1dERlc2NyaXB0aW9uLnZhbHVlID0gZG9tUmVmcy5wcm9maWxlRGVzY3JpcHRpb24udGV4dENvbnRlbnQ7XG5cbiAgcmVzZXRWYWxpZGF0aW9uKGRvbVNlY3Rpb25zLnByb2ZpbGVNb2RhbCwgW2RvbVJlZnMucHJvZmlsZUlucHV0TmFtZSwgZG9tUmVmcy5wcm9maWxlSW5wdXREZXNjcmlwdGlvbl0sIHNldHRpbmdzKTtcbiAgb3Blbk1vZGFsKGRvbVNlY3Rpb25zLnByb2ZpbGVNb2RhbCk7XG59KTtcblxuZW5hYmxlVmFsaWRhdGlvbihzZXR0aW5ncyk7Il0sIm5hbWVzIjpbIl9fd2VicGFja19yZXF1aXJlX18iLCJzZXR0aW5ncyIsImZvcm1TZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiaGlkZUlucHV0RXJyb3IiLCJmb3JtRWxlbWVudCIsImlucHV0RWxlbWVudCIsImNvbmZpZyIsInF1ZXJ5U2VsZWN0b3IiLCJpZCIsInRleHRDb250ZW50IiwiY2xhc3NMaXN0IiwicmVtb3ZlIiwiZGlzYWJsZUJ1dHRvbiIsImJ1dHRvbkVsZW1lbnQiLCJkaXNhYmxlZCIsImFkZCIsInRvZ2dsZUJ1dHRvblN0YXRlIiwiaW5wdXRMaXN0Iiwic29tZSIsImlucHV0IiwidmFsaWRpdHkiLCJ2YWxpZCIsImhhc0ludmFsaWRJbnB1dCIsImVuYWJsZUJ1dHRvbiIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJzcmMiLCJsb2dvIiwiYXZhdGFyIiwiZWRpdEljb24iLCJwb3N0SWNvbiIsImRvbVNlY3Rpb25zIiwicHJvZmlsZU1vZGFsIiwicGljdHVyZU1vZGFsIiwicG9zdE1vZGFsIiwicHJvZmlsZUZvcm0iLCJmb3JtcyIsInBvc3RGb3JtIiwiZG9tUmVmcyIsImNhcmRUZW1wbGF0ZSIsImNhcmRzTGlzdCIsInByb2ZpbGVFZGl0T3BlbkJ1dHRvbiIsInByb2ZpbGVDbG9zZUJ1dHRvbiIsInByb2ZpbGVOYW1lIiwicHJvZmlsZURlc2NyaXB0aW9uIiwicHJvZmlsZUlucHV0TmFtZSIsInByb2ZpbGVJbnB1dERlc2NyaXB0aW9uIiwicHJvZmlsZVNhdmVCdXR0b24iLCJwaWN0dXJlTW9kYWxJbWFnZSIsInBpY3R1cmVNb2RhbE5hbWUiLCJwaWN0dXJlQ2xvc2VCdXR0b24iLCJwb3N0TW9kYWxDbG9zZUJ1dHRvbiIsInBvc3RNb2RhbE9wZW5CdXR0b24iLCJwb3N0SW5wdXRMaW5rIiwicG9zdElucHV0TmFtZSIsInBvc3RTdWJtaXRCdXR0b24iLCJyZW5kZXJDYXJkIiwiZGF0YSIsIm1ldGhvZCIsImNhcmRFbGVtZW50IiwiY29udGVudCIsImNsb25lTm9kZSIsImNhcmREZXNjcmlwdGlvbkVsIiwiY2FyZEltYWdlRWwiLCJjYXJkTGlrZUJ0biIsImNhcmREZWxldGVCdG4iLCJuYW1lIiwibGluayIsImFsdCIsImFkZEV2ZW50TGlzdGVuZXIiLCJ0b2dnbGUiLCJvcGVuTW9kYWwiLCJnZXRDYXJkRWxlbWVudCIsIm1vZGFsIiwiZXZlbnRNZ3IiLCJhZGRFdmVudExpc3RlbmVycyIsImNsb3NlTW9kYWwiLCJyZW1vdmVFdmVudExpc3RlbmVycyIsImhhbmRsZUNsb3NlQnV0dG9uIiwiZXZ0IiwicG9wdXBNb2RhbCIsInRhcmdldCIsImNsb3Nlc3QiLCJjb250YWlucyIsImhhbmRsZUNsaWNrQ2xvc2UiLCJoYW5kbGVDbG9zZUtleSIsImtleSIsImZvckVhY2giLCJ1bmRlZmluZWQiLCJwcmV2ZW50RGVmYXVsdCIsInZhbHVlIiwicmVzZXQiLCJsaXN0ZW5lcnMiLCJoYW5kbGVyIiwiZXZlbnRUeXBlIiwiZWxlbWVudCIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJyZXNldFZhbGlkYXRpb24iLCJxdWVyeVNlbGVjdG9yQWxsIiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJBcnJheSIsImZyb20iLCJjaGVja0lucHV0VmFsaWRpdHkiLCJzaG93SW5wdXRFcnJvciIsImVycm9yTWVzc2FnZSIsInZhbGlkYXRpb25NZXNzYWdlIl0sInNvdXJjZVJvb3QiOiIifQ==